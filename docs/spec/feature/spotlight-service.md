# Spotlight Service ëª…ì„¸

## ê°œìš”

Spotlight ServiceëŠ” Mitì˜ ë©”ì¸ ì¸í„°í˜ì´ìŠ¤ë¡œ, ì‚¬ìš©ìê°€ ìì—°ì–´ ëª…ë ¹ì„ í†µí•´ ì‹œìŠ¤í…œê³¼ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆëŠ” í†µí•© ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. macOS Spotlightë‚˜ VS Code Command Paletteì™€ ìœ ì‚¬í•œ UXë¥¼ ì œê³µí•˜ë©°, ëª…ë ¹ ì…ë ¥, ëŒ€í™”í˜• í¼ ìƒì„±, ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°ë¥¼ í•˜ë‚˜ì˜ íë¦„ìœ¼ë¡œ í†µí•©í•©ë‹ˆë‹¤.

## í•µì‹¬ ê°€ì¹˜

| ê°€ì¹˜ | ì„¤ëª… |
|------|------|
| **í†µí•© ì¸í„°í˜ì´ìŠ¤** | ëª¨ë“  ì‘ì—…ì„ í•˜ë‚˜ì˜ ì…ë ¥ì°½ìœ¼ë¡œ ì²˜ë¦¬ |
| **ì»¨í…ìŠ¤íŠ¸ ìœ ì§€** | ëª…ë ¹ íˆìŠ¤í† ë¦¬ì™€ ê²°ê³¼ë¥¼ ìš°ì¸¡ íŒ¨ë„ì—ì„œ ì§€ì†ì ìœ¼ë¡œ ì°¸ì¡° |
| **ëŒ€í™”í˜• íë¦„** | í•„ìš” ì‹œ í¼ì„ ë™ì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ ì¶”ê°€ ì •ë³´ ìˆ˜ì§‘ |
| **ì¦‰ê°ì  í”¼ë“œë°±** | ëª…ë ¹ ì‹¤í–‰ ê²°ê³¼ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë¯¸ë¦¬ë³´ê¸° íŒ¨ë„ì— í‘œì‹œ |

---

## ì•„í‚¤í…ì²˜

### 3-Column ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MainLayout                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â”‚                                  â”‚               â”‚
â”‚  Left    â”‚        Center Content            â”‚    Right      â”‚
â”‚ Sidebar  â”‚      (SpotlightInput +           â”‚   Preview     â”‚
â”‚          â”‚       Suggestions +              â”‚    Panel      â”‚
â”‚  280px   â”‚        History)                  â”‚    400px      â”‚
â”‚          â”‚                                  â”‚               â”‚
â”‚  - Nav   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  - Team  â”‚  â”‚ CommandSuggestions     â”‚     â”‚  â”‚ Header  â”‚ â”‚
â”‚  - Menu  â”‚  â”‚   (ë¹ ë¥¸ ëª…ë ¹)          â”‚     â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚         â”‚ â”‚
â”‚          â”‚                                  â”‚  â”‚ Content â”‚ â”‚
â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚  â”‚         â”‚ â”‚
â”‚          â”‚  â”‚  SpotlightInput        â”‚     â”‚  â”‚         â”‚ â”‚
â”‚          â”‚  â”‚    + InteractiveForm   â”‚     â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚  Meta   â”‚ â”‚
â”‚          â”‚                                  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚          â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚               â”‚
â”‚          â”‚  â”‚ CommandHistory         â”‚     â”‚               â”‚
â”‚          â”‚  â”‚   (ìµœê·¼ í™œë™)          â”‚     â”‚               â”‚
â”‚          â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚               â”‚
â”‚          â”‚                                  â”‚               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë ˆì´ì•„ì›ƒ ê·œì¹™**
- ì¢Œì¸¡ ì‚¬ì´ë“œë°”: ê³ ì • 280px (ë„¤ë¹„ê²Œì´ì…˜, íŒ€ ëª©ë¡, í˜„ì¬ ì„¸ì…˜)
- ì¤‘ì•™ ì½˜í…ì¸ : flex-1 (ë°˜ì‘í˜•, ìµœì†Œ ë„ˆë¹„ í™•ë³´)
- ìš°ì¸¡ í”„ë¦¬ë·°: ê³ ì • 400px (ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°, ë©”íƒ€ë°ì´í„°)

---

## ì»´í¬ë„ŒíŠ¸ ê³„ì¸µ êµ¬ì¡°

### 1. í˜ì´ì§€ ë ˆì´ì–´

```
MainLayout (layouts/MainLayout.tsx)
â”œâ”€ LeftSidebar (components/sidebar/LeftSidebar.tsx)
â”œâ”€ MainPage (pages/MainPage.tsx)
â”‚  â”œâ”€ CommandSuggestions (components/spotlight/CommandSuggestions.tsx)
â”‚  â”œâ”€ SpotlightInput (components/spotlight/SpotlightInput.tsx)
â”‚  â”œâ”€ InteractiveForm (components/spotlight/InteractiveForm.tsx)
â”‚  â””â”€ CommandHistory (components/spotlight/CommandHistory.tsx)
â””â”€ RightSidebar (components/preview/RightSidebar.tsx)
   â”œâ”€ PreviewHeader
   â”œâ”€ PreviewContent
   â””â”€ PreviewMeta
```

### 2. Spotlight ì…ë ¥ ì»´í¬ë„ŒíŠ¸

**SpotlightInput.tsx**
- ì—­í• : ë©”ì¸ ëª…ë ¹ ì…ë ¥ì°½
- ê¸°ëŠ¥:
  - ìì—°ì–´ ëª…ë ¹ ì…ë ¥
  - Cmd+K ë‹¨ì¶•í‚¤ (í¬ì»¤ìŠ¤)
  - Enter ì œì¶œ, Shift+Enter ì¤„ë°”ê¿ˆ
  - ì²˜ë¦¬ ì¤‘ ìƒíƒœ í‘œì‹œ (Loader ì• ë‹ˆë©”ì´ì…˜)
- ìƒíƒœ:
  - `inputValue`: í˜„ì¬ ì…ë ¥ê°’
  - `isProcessing`: ëª…ë ¹ ì²˜ë¦¬ ì¤‘ ì—¬ë¶€
  - `isInputFocused`: í¬ì»¤ìŠ¤ ìƒíƒœ

```typescript
// ì£¼ìš” ê¸°ëŠ¥
- Cmd+K ê¸€ë¡œë²Œ ë‹¨ì¶•í‚¤ë¡œ í¬ì»¤ìŠ¤
- ì…ë ¥ê°’ì€ commandStoreì—ì„œ ê´€ë¦¬
- Enter ì‹œ submitCommand() í˜¸ì¶œ
```

### 3. ì¶”ì²œ ëª…ë ¹ ì»´í¬ë„ŒíŠ¸

**CommandSuggestions.tsx**
- ì—­í• : ë¹ ë¥¸ ì‹¤í–‰ì„ ìœ„í•œ ì¶”ì²œ ëª…ë ¹ ì¹´ë“œ
- ë°ì´í„°: `agentService.getSuggestions()`ì—ì„œ ë¡œë“œ
- í‘œì‹œ: 2-column ê·¸ë¦¬ë“œ (ìµœëŒ€ 4ê°œ ì œí•œ)
- ì¹´í…Œê³ ë¦¬: meeting, search, action, help

```typescript
interface Suggestion {
  id: string;
  title: string;
  description: string;
  icon: string;
  command: string;  // í´ë¦­ ì‹œ ì‹¤í–‰í•  ëª…ë ¹
  category: 'meeting' | 'search' | 'action' | 'help';
}
```

### 4. ëª…ë ¹ íˆìŠ¤í† ë¦¬ ì»´í¬ë„ŒíŠ¸

**CommandHistory.tsx**
- ì—­í• : ìµœê·¼ ì‹¤í–‰í•œ ëª…ë ¹ íˆìŠ¤í† ë¦¬ í‘œì‹œ
- ì œí•œ: ìµœëŒ€ 50ê°œ (HISTORY_LIMIT)
- í´ë¦­ ì‹œ: ìš°ì¸¡ ë¯¸ë¦¬ë³´ê¸° íŒ¨ë„ì— ê²°ê³¼ í‘œì‹œ
- ìƒíƒœ í‘œì‹œ: success(ì™„ë£Œ), error(ì‹¤íŒ¨), pending(ì§„í–‰)

```typescript
interface HistoryItem {
  id: string;
  command: string;
  result: string;
  timestamp: Date;
  icon: string;
  status: 'success' | 'error' | 'pending';
}
```

### 5. ëŒ€í™”í˜• í¼ ì»´í¬ë„ŒíŠ¸

**InteractiveForm.tsx**
- ì—­í• : ëª…ë ¹ì— í•„ìš”í•œ ì¶”ê°€ ì •ë³´ë¥¼ ë™ì ìœ¼ë¡œ ìˆ˜ì§‘
- íŠ¸ë¦¬ê±°: `agentService`ê°€ ì‘ë‹µ íƒ€ì… 'form' ë°˜í™˜ ì‹œ
- ì• ë‹ˆë©”ì´ì…˜: Framer Motionìœ¼ë¡œ ë¶€ë“œëŸ¬ìš´ ë“±ì¥/í‡´ì¥
- í•„ë“œ íƒ€ì…:
  - `text`: í…ìŠ¤íŠ¸ ì…ë ¥
  - `textarea`: ì—¬ëŸ¬ ì¤„ ì…ë ¥
  - `select`: ë“œë¡­ë‹¤ìš´ ì„ íƒ
  - `date`: ë‚ ì§œ ì„ íƒ
  - `number`: ìˆ«ì ì…ë ¥

```typescript
interface CommandField {
  id: string;
  label: string;
  type: 'text' | 'number' | 'select' | 'date' | 'textarea';
  value?: string;
  placeholder?: string;
  options?: string[];  // select íƒ€ì… ì „ìš©
  required?: boolean;
}

interface ActiveCommand {
  id: string;
  type: string;
  title: string;
  description: string;
  fields: CommandField[];
  icon?: string;
}
```

**í¼ ìƒì„± ì˜ˆì‹œ**
```typescript
// "íšŒì˜ë¡ ê²€ìƒ‰" ëª…ë ¹ ì‹œ
{
  title: 'íšŒì˜ë¡ ê²€ìƒ‰',
  description: 'ê²€ìƒ‰ ì¡°ê±´ì„ ì…ë ¥í•´ì£¼ì„¸ìš”',
  icon: 'ğŸ”',
  fields: [
    { id: 'keyword', label: 'ê²€ìƒ‰ì–´', type: 'text', required: true },
    { id: 'dateRange', label: 'ê²€ìƒ‰ ê¸°ê°„', type: 'select',
      options: ['ìµœê·¼ 1ì£¼ì¼', 'ìµœê·¼ 1ê°œì›”', 'ìµœê·¼ 3ê°œì›”', 'ì „ì²´ ê¸°ê°„'] },
    { id: 'team', label: 'íŒ€ í•„í„°', type: 'select',
      options: ['ì „ì²´', 'ê°œë°œíŒ€', 'ë””ìì¸íŒ€', 'ë§ˆì¼€íŒ…íŒ€'] }
  ]
}
```

---

## ëª…ë ¹ ì‹¤í–‰ íë¦„

### ì „ì²´ íŒŒì´í”„ë¼ì¸

```
[ì‚¬ìš©ì ì…ë ¥]
     |
     v
[SpotlightInput] â”€â”€> submitCommand()
     |
     v
[agentService.processCommand()] â”€â”€> í‚¤ì›Œë“œ ë§¤ì¹­
     |
     +â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€+
     v              v              v              v
  'direct'       'form'        'modal'      (ì—ëŸ¬)
     |              |              |              |
     v              v              v              v
íˆìŠ¤í† ë¦¬ ì¶”ê°€   í¼ í‘œì‹œ    ëª¨ë‹¬ ì˜¤í”ˆ    ì—ëŸ¬ íˆìŠ¤í† ë¦¬
     |              |
     v              v
ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸   [ì‚¬ìš©ì í¼ ì‘ì„±]
                    |
                    v
               submitForm()
                    |
                    v
            agentService.submitForm()
                    |
                    v
               íˆìŠ¤í† ë¦¬ ì¶”ê°€
                    |
                    v
            ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
```

### 1. ëª…ë ¹ ì…ë ¥ ë‹¨ê³„

```typescript
// useCommand.ts - submitCommand()
const submitCommand = async (command?: string) => {
  const cmd = command || inputValue;
  if (!cmd.trim()) return;

  setProcessing(true);
  setInputValue('');

  try {
    // agentServiceë¥¼ í†µí•´ ëª…ë ¹ ì²˜ë¦¬
    const response = await agentService.processCommand(cmd);

    // ì‘ë‹µ íƒ€ì…ì— ë”°ë¥¸ ë¶„ê¸° ì²˜ë¦¬
    if (response.type === 'modal') {
      // ëª¨ë‹¬ ì˜¤í”ˆ (ì˜ˆ: íšŒì˜ ìƒì„±)
      openMeetingModal(response.modalData);
    } else if (response.type === 'form') {
      // ëŒ€í™”í˜• í¼ í‘œì‹œ
      setActiveCommand(response.command);
    } else {
      // ì§ì ‘ ê²°ê³¼ í‘œì‹œ
      addHistory({...});
      setPreview(response.previewData);
    }
  } catch (error) {
    addHistory({ status: 'error', ... });
  } finally {
    setProcessing(false);
  }
};
```

### 2. AgentService ì²˜ë¦¬ ë‹¨ê³„

**í‚¤ì›Œë“œ ê¸°ë°˜ ëª…ë ¹ ë§¤ì¹­**

```typescript
// agentService.ts - matchCommand()
function matchCommand(command: string): MockResponse {
  const lowerCommand = command.toLowerCase();

  // íšŒì˜ ì‹œì‘/ìƒì„±
  if (lowerCommand.includes('íšŒì˜') &&
      (lowerCommand.includes('ì‹œì‘') || lowerCommand.includes('ë§Œë“¤'))) {
    return { type: 'modal', modalData: { modalType: 'meeting' } };
  }

  // ê²€ìƒ‰
  if (lowerCommand.includes('ê²€ìƒ‰') || lowerCommand.includes('ì°¾')) {
    return { type: 'form', fields: [...] };
  }

  // Blame / ì´ë ¥
  if (lowerCommand.includes('blame') || lowerCommand.includes('ì´ë ¥')) {
    return { type: 'direct', message: '...', previewContent: '...' };
  }

  // ê¸°ë³¸ ì‘ë‹µ
  return { type: 'form', fields: [...] };
}
```

**ì‘ë‹µ íƒ€ì…ë³„ ì²˜ë¦¬**

| íƒ€ì… | ì„¤ëª… | ë°˜í™˜ ë°ì´í„° |
|------|------|-----------|
| `direct` | ì¦‰ì‹œ ê²°ê³¼ í‘œì‹œ | `message`, `previewData` |
| `form` | ì¶”ê°€ ì •ë³´ í•„ìš” | `command` (ActiveCommand) |
| `modal` | ëª¨ë‹¬ UI í•„ìš” | `modalData` (ModalData) |

### 3. í¼ ì œì¶œ ë‹¨ê³„

```typescript
// useCommand.ts - submitForm()
const submitForm = async () => {
  if (!activeCommand) return;

  setProcessing(true);

  try {
    // í•„ë“œ ê°’ ì¶”ì¶œ
    const fieldValues: Record<string, string> = {};
    activeCommand.fields.forEach((f) => {
      if (f.value) fieldValues[f.id] = f.value;
    });

    // agentServiceë¥¼ í†µí•´ Form ì œì¶œ
    const response = await agentService.submitForm(
      activeCommand.id,
      activeCommand.title,
      fieldValues
    );

    // íˆìŠ¤í† ë¦¬ ì¶”ê°€ ë° ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
    addHistory({...});
    setPreview('command-result', response.previewData);

    clearActiveCommand();
  } catch (error) {
    addHistory({ status: 'error', ... });
  }
};
```

---

## ìƒíƒœ ê´€ë¦¬ (Zustand Stores)

### 1. CommandStore (stores/commandStore.ts)

**ì—­í• **: ëª…ë ¹ ì…ë ¥, íˆìŠ¤í† ë¦¬, í™œì„± í¼ ê´€ë¦¬

```typescript
interface CommandState {
  // ìƒíƒœ
  inputValue: string;              // í˜„ì¬ ì…ë ¥ê°’
  isInputFocused: boolean;         // í¬ì»¤ìŠ¤ ìƒíƒœ
  isProcessing: boolean;           // ëª…ë ¹ ì²˜ë¦¬ ì¤‘
  activeCommand: ActiveCommand | null;  // í™œì„± í¼
  history: HistoryItem[];          // ëª…ë ¹ íˆìŠ¤í† ë¦¬ (ìµœëŒ€ 50ê°œ)
  suggestions: Suggestion[];       // ì¶”ì²œ ëª…ë ¹

  // Actions
  setInputValue: (value: string) => void;
  setInputFocused: (focused: boolean) => void;
  setProcessing: (processing: boolean) => void;
  setActiveCommand: (command: ActiveCommand | null) => void;
  updateField: (fieldId: string, value: string) => void;  // í¼ í•„ë“œ ì—…ë°ì´íŠ¸
  addHistory: (item: HistoryItem) => void;
  clearHistory: () => void;
  clearActiveCommand: () => void;
  setSuggestions: (suggestions: Suggestion[]) => void;
}
```

**íˆìŠ¤í† ë¦¬ ê´€ë¦¬**
- ìµœëŒ€ 50ê°œ ì œí•œ (HISTORY_LIMIT)
- ìµœì‹  í•­ëª©ì´ ìƒë‹¨ì— í‘œì‹œ
- ê° í•­ëª©ì€ ìƒíƒœ(success/error/pending)ì™€ íƒ€ì„ìŠ¤íƒ¬í”„ í¬í•¨

### 2. PreviewStore (stores/previewStore.ts)

**ì—­í• **: ìš°ì¸¡ ë¯¸ë¦¬ë³´ê¸° íŒ¨ë„ ìƒíƒœ ê´€ë¦¬

```typescript
interface PreviewState {
  previewType: PreviewType;        // í˜„ì¬ ë¯¸ë¦¬ë³´ê¸° íƒ€ì…
  previewData: PreviewData | null; // ë¯¸ë¦¬ë³´ê¸° ë°ì´í„°
  isLoading: boolean;              // ë¡œë”© ìƒíƒœ

  // Actions
  setPreview: (type: PreviewType, data: PreviewData | null) => void;
  clearPreview: () => void;
  setLoading: (loading: boolean) => void;
}

type PreviewType = 'empty' | 'meeting' | 'document' | 'search-result' | 'command-result';

interface PreviewData {
  id?: string;
  title?: string;
  description?: string;
  content?: string;              // Markdown ì§€ì›
  metadata?: Record<string, unknown>;
  createdAt?: string;
  updatedAt?: string;
}
```

**ë¯¸ë¦¬ë³´ê¸° íƒ€ì…ë³„ ìš©ë„**

| íƒ€ì… | ì‚¬ìš© ì¼€ì´ìŠ¤ |
|------|-----------|
| `empty` | ì´ˆê¸° ìƒíƒœ, ì•„ë¬´ê²ƒë„ ì„ íƒë˜ì§€ ì•ŠìŒ |
| `meeting` | íšŒì˜ ì •ë³´ í‘œì‹œ |
| `document` | ë¬¸ì„œ ë‚´ìš© í‘œì‹œ |
| `search-result` | ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ |
| `command-result` | ëª…ë ¹ ì‹¤í–‰ ê²°ê³¼ í‘œì‹œ |

### 3. MeetingModalStore (stores/meetingModalStore.ts)

**ì—­í• **: íšŒì˜ ìƒì„± ëª¨ë‹¬ ìƒíƒœ ê´€ë¦¬

```typescript
interface MeetingModalState {
  isOpen: boolean;
  initialData: MeetingModalData | null;

  openModal: (data?: MeetingModalData) => void;
  closeModal: () => void;
}

interface MeetingModalData {
  title?: string;
  description?: string;
  scheduledAt?: string;
  teamId?: string;
}
```

---

## í›… (Hooks)

### useCommand (hooks/useCommand.ts)

**ì—­í• **: ëª…ë ¹ ì‹¤í–‰ ë¡œì§ì„ ìº¡ìŠí™”í•œ ì»¤ìŠ¤í…€ í›…

```typescript
export function useCommand() {
  const {
    inputValue,
    activeCommand,
    setInputValue,
    setProcessing,
    setActiveCommand,
    updateField,
    addHistory,
    clearActiveCommand,
  } = useCommandStore();

  const { setPreview } = usePreviewStore();
  const { openModal: openMeetingModal } = useMeetingModalStore();

  return {
    inputValue,
    activeCommand,
    setInputValue,
    submitCommand,    // ëª…ë ¹ ì œì¶œ
    submitForm,       // í¼ ì œì¶œ
    cancelCommand,    // ëª…ë ¹ ì·¨ì†Œ
    updateField,      // í¼ í•„ë“œ ì—…ë°ì´íŠ¸
  };
}
```

**ì‚¬ìš© ì˜ˆì‹œ**
```typescript
function SpotlightInput() {
  const { inputValue, setInputValue, submitCommand } = useCommand();

  const handleSubmit = () => {
    if (!inputValue.trim()) return;
    submitCommand();
  };

  return (
    <input
      value={inputValue}
      onChange={(e) => setInputValue(e.target.value)}
      onKeyDown={(e) => e.key === 'Enter' && handleSubmit()}
    />
  );
}
```

---

## AgentService (Mock êµ¬í˜„)

### í˜„ì¬ êµ¬í˜„ (services/agentService.ts)

**ëª©ì **: ë°±ì—”ë“œ API ì—°ë™ ì „ê¹Œì§€ ì‚¬ìš©í•˜ëŠ” Mock ì„œë¹„ìŠ¤

```typescript
export const agentService = {
  /**
   * ëª…ë ¹ì–´ ì²˜ë¦¬
   * @param command ì‚¬ìš©ìê°€ ì…ë ¥í•œ ëª…ë ¹ì–´
   * @returns AgentResponse
   */
  async processCommand(command: string): Promise<AgentResponse> {
    // API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜ (500ms ë”œë ˆì´)
    await new Promise((resolve) => setTimeout(resolve, 500));

    const matched = matchCommand(command);

    if (matched.type === 'modal') {
      return { type: 'modal', modalData: matched.modalData };
    }

    if (matched.type === 'form') {
      return { type: 'form', command: {...} };
    }

    return { type: 'direct', message: '...', previewData: {...} };
  },

  /**
   * Form ì œì¶œ ì²˜ë¦¬
   */
  async submitForm(
    commandId: string,
    commandTitle: string,
    fields: Record<string, string>
  ): Promise<AgentResponse> {
    // API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜ (800ms ë”œë ˆì´)
    await new Promise((resolve) => setTimeout(resolve, 800));

    return {
      type: 'direct',
      message: `${commandTitle}ì´(ê°€) ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë˜ì—ˆìŠµë‹ˆë‹¤.`,
      previewData: {...}
    };
  },

  /**
   * ì¶”ì²œ ëª…ë ¹ì–´ ì¡°íšŒ
   */
  async getSuggestions() {
    // API í˜¸ì¶œ ì‹œë®¬ë ˆì´ì…˜ (200ms ë”œë ˆì´)
    await new Promise((resolve) => setTimeout(resolve, 200));

    return [
      { id: '1', title: 'ìƒˆ íšŒì˜ ì‹œì‘', command: 'ìƒˆ íšŒì˜ ì‹œì‘', ... },
      { id: '2', title: 'ì§€ë‚œ íšŒì˜ë¡ ê²€ìƒ‰', command: 'íšŒì˜ë¡ ê²€ìƒ‰', ... },
      { id: '3', title: 'ì˜¤ëŠ˜ ì¼ì • í™•ì¸', command: 'ì˜¤ëŠ˜ ì¼ì •', ... },
      { id: '4', title: 'íŒ€ í˜„í™© ë³´ê¸°', command: 'íŒ€ í˜„í™©', ... },
    ];
  },
};
```

### í‚¤ì›Œë“œ ë§¤ì¹­ ê·œì¹™

| í‚¤ì›Œë“œ ì¡°í•© | ë§¤ì¹­ ê²°ê³¼ | ì‘ë‹µ íƒ€ì… |
|-----------|---------|---------|
| "íšŒì˜" + ("ì‹œì‘" \| "ìƒˆ" \| "ë§Œë“¤") | íšŒì˜ ìƒì„± | modal |
| "ê²€ìƒ‰" \| "ì°¾" | íšŒì˜ë¡ ê²€ìƒ‰ | form |
| "ì˜ˆì‚°" (ì´ë ¥ ì œì™¸) | ì˜ˆì‚° ë³€ê²½ ì œì•ˆ | form |
| "blame" \| "ì´ë ¥" \| "íˆìŠ¤í† ë¦¬" | Blame ì¡°íšŒ | direct |
| "ì¼ì •" \| "ìŠ¤ì¼€ì¤„" \| "ì˜¤ëŠ˜" | ì¼ì • ì¡°íšŒ | direct |
| "íŒ€" + ("í˜„í™©" \| "ìƒíƒœ") | íŒ€ í˜„í™© | direct |

### ë°±ì—”ë“œ ì—°ë™ ì „í™˜ ê³„íš

```typescript
// TODO: ë°±ì—”ë“œ API ì—°ë™ ì‹œ êµì²´
export const agentService = {
  async processCommand(command: string): Promise<AgentResponse> {
    // POST /api/v1/agent/command
    const response = await fetch('/api/v1/agent/command', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ command }),
    });
    return response.json();
  },

  async submitForm(commandId: string, commandTitle: string, fields: Record<string, string>) {
    // POST /api/v1/agent/form-submit
    const response = await fetch('/api/v1/agent/form-submit', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ commandId, commandTitle, fields }),
    });
    return response.json();
  },

  async getSuggestions() {
    // GET /api/v1/agent/suggestions
    const response = await fetch('/api/v1/agent/suggestions');
    return response.json();
  },
};
```

---

## ìƒìˆ˜ ì •ì˜ (constants/index.ts)

```typescript
// íˆìŠ¤í† ë¦¬ ë° UI ìƒìˆ˜
export const HISTORY_LIMIT = 50;
export const SUGGESTIONS_DISPLAY_LIMIT = 4;

// Status ìƒ‰ìƒ ë§¤í•‘
export const STATUS_COLORS = {
  success: 'bg-mit-success/20 text-mit-success',
  error: 'bg-mit-warning/20 text-mit-warning',
  pending: 'bg-mit-primary/20 text-mit-primary',
} as const;

// Preview íƒ€ì´í‹€ ë§¤í•‘
export const PREVIEW_TITLES: Record<string, string> = {
  empty: 'Preview',
  meeting: 'Meeting Details',
  document: 'Document Preview',
  'search-result': 'Search Result',
  'command-result': 'Command Result',
};

// API ë”œë ˆì´ (Mock)
export const API_DELAYS = {
  COMMAND_PROCESS: 500,
  FORM_SUBMIT: 800,
  SUGGESTIONS_FETCH: 200,
} as const;
```

---

## ìœ í‹¸ë¦¬í‹° (utils/dateUtils.ts)

```typescript
/**
 * ìƒëŒ€ ì‹œê°„ í¬ë§·íŒ…
 * ì˜ˆ: "ë°©ê¸ˆ ì „", "3ë¶„ ì „", "2ì‹œê°„ ì „", "ì–´ì œ", "2ì¼ ì „"
 */
export function formatRelativeTime(date: Date): string {
  const now = new Date();
  const diffMs = now.getTime() - date.getTime();
  const diffSec = Math.floor(diffMs / 1000);
  const diffMin = Math.floor(diffSec / 60);
  const diffHour = Math.floor(diffMin / 60);
  const diffDay = Math.floor(diffHour / 24);

  if (diffSec < 60) return 'ë°©ê¸ˆ ì „';
  if (diffMin < 60) return `${diffMin}ë¶„ ì „`;
  if (diffHour < 24) return `${diffHour}ì‹œê°„ ì „`;
  if (diffDay === 1) return 'ì–´ì œ';
  if (diffDay < 7) return `${diffDay}ì¼ ì „`;

  return date.toLocaleDateString('ko-KR', {
    month: 'short',
    day: 'numeric',
  });
}

/**
 * ê¸°ê°„ í¬ë§·íŒ…
 * ì˜ˆ: "1ë¶„ 30ì´ˆ", "2ì‹œê°„ 15ë¶„"
 */
export function formatDuration(seconds: number): string {
  const hours = Math.floor(seconds / 3600);
  const minutes = Math.floor((seconds % 3600) / 60);
  const secs = seconds % 60;

  if (hours > 0) return `${hours}ì‹œê°„ ${minutes}ë¶„`;
  if (minutes > 0) return `${minutes}ë¶„ ${secs}ì´ˆ`;
  return `${secs}ì´ˆ`;
}
```

---

## UI/UX ì„¸ë¶€ì‚¬í•­

### 1. ìŠ¤íƒ€ì¼ë§ (Tailwind CSS)

**Glass íš¨ê³¼**
```css
.glass-input {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
}

.glass-card {
  background: rgba(255, 255, 255, 0.03);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.glass-card-hover:hover {
  background: rgba(255, 255, 255, 0.07);
  border-color: rgba(255, 255, 255, 0.2);
}
```

**ì•„ì´ì½˜ ì»¨í…Œì´ë„ˆ**
```css
.icon-container {
  width: 40px;
  height: 40px;
  border-radius: 10px;
  background: rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
}

.icon-container-sm {
  width: 32px;
  height: 32px;
}
```

**ë‹¨ì¶•í‚¤ íŒíŠ¸**
```css
.shortcut-key {
  padding: 2px 8px;
  border-radius: 4px;
  background: rgba(255, 255, 255, 0.1);
  font-size: 12px;
  color: rgba(255, 255, 255, 0.6);
}
```

### 2. ì• ë‹ˆë©”ì´ì…˜ (Framer Motion)

**InteractiveForm ë“±ì¥/í‡´ì¥**
```typescript
<motion.div
  initial={{ opacity: 0, y: -20, height: 0 }}
  animate={{ opacity: 1, y: 0, height: 'auto' }}
  exit={{ opacity: 0, y: -20, height: 0 }}
  transition={{ duration: 0.2, ease: 'easeOut' }}
>
  <InteractiveForm />
</motion.div>
```

**CommandCard hover íš¨ê³¼**
```typescript
<button className="glass-card-hover transition-all duration-200">
  // í˜¸ë²„ ì‹œ ë°°ê²½ìƒ‰ ë³€í™”, í…Œë‘ë¦¬ ë°ì•„ì§
</button>
```

### 3. í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤

| ë‹¨ì¶•í‚¤ | ë™ì‘ |
|--------|------|
| `Cmd+K` (Mac) / `Ctrl+K` (Win) | SpotlightInput í¬ì»¤ìŠ¤ |
| `Enter` | ëª…ë ¹ ì œì¶œ / í¼ ì œì¶œ |
| `Shift+Enter` | ì¤„ë°”ê¿ˆ (textarea) |
| `Esc` | í¼ ì·¨ì†Œ (ê³„íš) |

---

## í™•ì¥ ê³„íš

### 1. ìë™ì™„ì„± (Autocomplete)

**ê³„íš**
- ì…ë ¥ ì¤‘ ì‹¤ì‹œê°„ ëª…ë ¹ì–´ ì¶”ì²œ
- ê³¼ê±° íˆìŠ¤í† ë¦¬ ê¸°ë°˜ ìë™ì™„ì„±
- íŒ€ ë©¤ë²„, íšŒì˜, Agenda ì´ë¦„ ìë™ì™„ì„±

```typescript
// ê³„íšëœ êµ¬í˜„
interface AutocompleteItem {
  id: string;
  type: 'command' | 'meeting' | 'agenda' | 'member';
  text: string;
  icon?: string;
  score: number;  // ê´€ë ¨ë„ ì ìˆ˜
}

// inputValue ë³€ê²½ ì‹œ debounceë¡œ ìë™ì™„ì„± ì¡°íšŒ
useEffect(() => {
  const timer = setTimeout(() => {
    if (inputValue.length >= 2) {
      agentService.getAutocomplete(inputValue).then(setAutocompleteItems);
    }
  }, 300);
  return () => clearTimeout(timer);
}, [inputValue]);
```

### 2. ìŒì„± ì…ë ¥ (Voice Input)

**ê³„íš**
- SpotlightInputì˜ ë§ˆì´í¬ ë²„íŠ¼ í™œì„±í™”
- Web Speech API (ë¸Œë¼ìš°ì € STT)
- ìŒì„± -> í…ìŠ¤íŠ¸ ë³€í™˜ í›„ ëª…ë ¹ ì‹¤í–‰

```typescript
// ê³„íšëœ êµ¬í˜„
const startVoiceInput = () => {
  const recognition = new webkitSpeechRecognition();
  recognition.lang = 'ko-KR';
  recognition.onresult = (event) => {
    const transcript = event.results[0][0].transcript;
    setInputValue(transcript);
    submitCommand(transcript);
  };
  recognition.start();
};
```

### 3. ëª…ë ¹ ì²´ì´ë‹ (Command Chaining)

**ê³„íš**
- ì—¬ëŸ¬ ëª…ë ¹ì„ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ì—°ê²°
- ì˜ˆ: "íšŒì˜ë¡ ê²€ìƒ‰ -> Notion ì €ì¥ -> Slack ê³µìœ "

```typescript
// ê³„íšëœ êµ¬í˜„
interface ChainedCommand {
  commands: Array<{
    action: string;
    params: Record<string, any>;
  }>;
}

// ì˜ˆì‹œ: "ì§€ë‚œì£¼ ì˜ˆì‚° íšŒì˜ ê²€ìƒ‰í•´ì„œ Driveì— ì €ì¥í•˜ê³  íŒ€ ì±„ë„ì— ê³µìœ í•´ì¤˜"
{
  commands: [
    { action: 'mit_search', params: { query: 'ì§€ë‚œì£¼ ì˜ˆì‚° íšŒì˜' } },
    { action: 'mcp_drive', params: { action: 'upload' } },
    { action: 'mcp_slack', params: { channel: '#team' } },
  ]
}
```

### 4. í…œí”Œë¦¿ ëª…ë ¹ (Command Templates)

**ê³„íš**
- ìì£¼ ì‚¬ìš©í•˜ëŠ” ëª…ë ¹ì„ í…œí”Œë¦¿ìœ¼ë¡œ ì €ì¥
- íŒŒë¼ë¯¸í„°ë§Œ ì±„ì›Œì„œ ë¹ ë¥´ê²Œ ì‹¤í–‰

```typescript
interface CommandTemplate {
  id: string;
  name: string;
  description: string;
  command: string;
  params: Array<{
    key: string;
    label: string;
    type: FieldType;
  }>;
}

// ì˜ˆì‹œ: "ì£¼ê°„ íšŒì˜ ìƒì„±" í…œí”Œë¦¿
{
  name: 'ì£¼ê°„ íšŒì˜ ìƒì„±',
  command: 'create_weekly_meeting',
  params: [
    { key: 'week', label: 'ì£¼ì°¨', type: 'number' },
    { key: 'date', label: 'ë‚ ì§œ', type: 'date' },
  ]
}
```

---

## ì„±ëŠ¥ ìµœì í™”

### 1. íˆìŠ¤í† ë¦¬ ê°€ìƒí™” (Virtual Scrolling)

**í˜„ì¬**: ì „ì²´ íˆìŠ¤í† ë¦¬ ë Œë”ë§ (ìµœëŒ€ 50ê°œ)
**ê³„íš**: react-virtualë¡œ ê°€ì‹œ ì˜ì—­ë§Œ ë Œë”ë§

### 2. ë””ë°”ìš´ì‹± (Debouncing)

**ì ìš© ì˜ì—­**
- ìë™ì™„ì„± ì¡°íšŒ (300ms)
- í¼ í•„ë“œ ìœ íš¨ì„± ê²€ì‚¬ (200ms)

### 3. ë©”ëª¨ì´ì œì´ì…˜ (Memoization)

```typescript
// CommandHistory ì»´í¬ë„ŒíŠ¸
const CommandHistory = memo(() => {
  const { history } = useCommandStore();

  const sortedHistory = useMemo(() => {
    return [...history].sort((a, b) =>
      b.timestamp.getTime() - a.timestamp.getTime()
    );
  }, [history]);

  return (
    <div>
      {sortedHistory.map((item) => (
        <CommandCard key={item.id} item={item} />
      ))}
    </div>
  );
});
```

---

## í…ŒìŠ¤íŠ¸ ì „ëµ

### 1. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Unit Tests)

**ëŒ€ìƒ**
- agentService í‚¤ì›Œë“œ ë§¤ì¹­ ë¡œì§
- dateUtils ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
- Zustand store actions

```typescript
// agentService.test.ts
describe('agentService.matchCommand', () => {
  it('íšŒì˜ ìƒì„± í‚¤ì›Œë“œ ë§¤ì¹­', () => {
    const result = matchCommand('ìƒˆ íšŒì˜ ì‹œì‘');
    expect(result.type).toBe('modal');
    expect(result.modalData?.modalType).toBe('meeting');
  });

  it('ê²€ìƒ‰ í‚¤ì›Œë“œ ë§¤ì¹­', () => {
    const result = matchCommand('íšŒì˜ë¡ ê²€ìƒ‰');
    expect(result.type).toBe('form');
    expect(result.fields).toBeDefined();
  });
});
```

### 2. í†µí•© í…ŒìŠ¤íŠ¸ (Integration Tests)

**ì‹œë‚˜ë¦¬ì˜¤**
1. ëª…ë ¹ ì…ë ¥ -> í¼ ìƒì„± -> í¼ ì œì¶œ -> íˆìŠ¤í† ë¦¬ ì¶”ê°€ -> ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
2. ì¶”ì²œ ëª…ë ¹ í´ë¦­ -> ì¦‰ì‹œ ì‹¤í–‰ -> ê²°ê³¼ í‘œì‹œ

### 3. E2E í…ŒìŠ¤íŠ¸ (End-to-End Tests)

**Playwright ì‹œë‚˜ë¦¬ì˜¤**
```typescript
test('Spotlight ëª…ë ¹ ì‹¤í–‰ íë¦„', async ({ page }) => {
  await page.goto('/');

  // 1. Cmd+Kë¡œ í¬ì»¤ìŠ¤
  await page.keyboard.press('Meta+K');

  // 2. ëª…ë ¹ ì…ë ¥
  await page.fill('input[placeholder*="Mitì—ê²Œ"]', 'íšŒì˜ë¡ ê²€ìƒ‰');
  await page.press('input[placeholder*="Mitì—ê²Œ"]', 'Enter');

  // 3. í¼ í‘œì‹œ í™•ì¸
  await expect(page.locator('text=íšŒì˜ë¡ ê²€ìƒ‰')).toBeVisible();

  // 4. í¼ ì‘ì„±
  await page.fill('input[placeholder*="ê²€ìƒ‰ì–´"]', 'Q1 íšŒê³ ');
  await page.selectOption('select', 'ìµœê·¼ 1ê°œì›”');

  // 5. ì‹¤í–‰
  await page.click('button:has-text("ì‹¤í–‰")');

  // 6. íˆìŠ¤í† ë¦¬ ì¶”ê°€ í™•ì¸
  await expect(page.locator('text=íšŒì˜ë¡ ê²€ìƒ‰').first()).toBeVisible();

  // 7. ë¯¸ë¦¬ë³´ê¸° íŒ¨ë„ ì—…ë°ì´íŠ¸ í™•ì¸
  await expect(page.locator('[role="complementary"]')).toContainText('íšŒì˜ë¡ ê²€ìƒ‰ ê²°ê³¼');
});
```

---

## íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### 1. í¼ ì• ë‹ˆë©”ì´ì…˜ ê¹œë¹¡ì„

**ë¬¸ì œ**: InteractiveFormì´ ë“±ì¥/í‡´ì¥ ì‹œ ê¹œë¹¡ì´ëŠ” í˜„ìƒ
**ì›ì¸**: AnimatePresenceì˜ mode ì„¤ì • ì˜¤ë¥˜
**í•´ê²°**: `mode="wait"` ì„¤ì •ìœ¼ë¡œ í‡´ì¥ ì™„ë£Œ í›„ ë“±ì¥

```typescript
<AnimatePresence mode="wait">
  {activeCommand && <InteractiveForm command={activeCommand} />}
</AnimatePresence>
```

### 2. íˆìŠ¤í† ë¦¬ ì¤‘ë³µ ì¶”ê°€

**ë¬¸ì œ**: ë™ì¼ ëª…ë ¹ì´ íˆìŠ¤í† ë¦¬ì— ì¤‘ë³µ ì¶”ê°€
**ì›ì¸**: submitCommandì™€ submitFormì—ì„œ ê°ê° addHistory í˜¸ì¶œ
**í•´ê²°**: submitFormì—ì„œë§Œ íˆìŠ¤í† ë¦¬ ì¶”ê°€ (submitCommandëŠ” form íƒ€ì… ì‹œ skip)

### 3. í”„ë¦¬ë·° íƒ€ì… ë¶ˆì¼ì¹˜ ì—ëŸ¬

**ë¬¸ì œ**: `Unknown preview type: xxx` ê²½ê³  ë°œìƒ
**ì›ì¸**: agentServiceê°€ ë°˜í™˜í•œ previewTypeì´ PreviewType enumì— ì—†ìŒ
**í•´ê²°**: ìœ íš¨ì„± ê²€ì‚¬ í›„ fallback

```typescript
const previewType = response.previewData.type;
if (isValidPreviewType(previewType)) {
  setPreview(previewType, response.previewData);
} else {
  console.warn(`Unknown preview type: ${previewType}, falling back to command-result`);
  setPreview('command-result', response.previewData);
}
```

---

## ì°¸ì¡°

- íƒ€ì… ì •ì˜: [app/types/command.ts](../../../frontend/src/app/types/command.ts)
- Agent ì„œë¹„ìŠ¤: [app/services/agentService.ts](../../../frontend/src/app/services/agentService.ts)
- ëª…ë ¹ ìŠ¤í† ì–´: [app/stores/commandStore.ts](../../../frontend/src/app/stores/commandStore.ts)
- ë¯¸ë¦¬ë³´ê¸° ìŠ¤í† ì–´: [app/stores/previewStore.ts](../../../frontend/src/app/stores/previewStore.ts)
- ë©”ì¸ ë ˆì´ì•„ì›ƒ: [app/layouts/MainLayout.tsx](../../../frontend/src/app/layouts/MainLayout.tsx)
- ê°œìš” ë¬¸ì„œ: [00-overview.md](../00-overview.md)
- ìœ ì¦ˆì¼€ì´ìŠ¤: [usecase/01-usecase-specs.md](../usecase/01-usecase-specs.md)
