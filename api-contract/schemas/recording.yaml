components:
  schemas:
    RecordingStatus:
      type: string
      enum:
        - pending
        - recording
        - completed
        - failed
        - transcribing
        - transcribed
        - transcription_failed
      description: |
        녹음 상태:
        - pending: 업로드 대기
        - recording: 녹음 중
        - completed: 녹음 완료
        - failed: 녹음 실패
        - transcribing: STT 변환 중
        - transcribed: STT 완료
        - transcription_failed: STT 실패

    Recording:
      type: object
      required:
        - id
        - meetingId
        - userId
        - status
        - startedAt
        - createdAt
      properties:
        id:
          $ref: './common.yaml#/components/schemas/UUID'
        meetingId:
          $ref: './common.yaml#/components/schemas/UUID'
        userId:
          $ref: './common.yaml#/components/schemas/UUID'
        userName:
          type: string
          nullable: true
        status:
          $ref: '#/components/schemas/RecordingStatus'
        startedAt:
          $ref: './common.yaml#/components/schemas/Timestamp'
        endedAt:
          type: string
          format: date-time
          nullable: true
        durationMs:
          type: integer
          nullable: true
          description: 녹음 길이 (밀리초)
        fileSizeBytes:
          type: integer
          nullable: true
          description: 파일 크기 (바이트)
        createdAt:
          $ref: './common.yaml#/components/schemas/Timestamp'
        # STT 관련 필드
        transcriptText:
          type: string
          nullable: true
          description: STT 변환된 전체 텍스트
        transcriptLanguage:
          type: string
          nullable: true
          description: 감지된 언어 코드 (ko, en 등)
        transcriptionStartedAt:
          type: string
          format: date-time
          nullable: true
          description: STT 변환 시작 시간
        transcriptionCompletedAt:
          type: string
          format: date-time
          nullable: true
          description: STT 변환 완료 시간
        transcriptionError:
          type: string
          nullable: true
          description: STT 실패 시 에러 메시지

    RecordingListResponse:
      type: object
      required:
        - items
        - meta
      properties:
        items:
          type: array
          items:
            $ref: '#/components/schemas/Recording'
        meta:
          $ref: './common.yaml#/components/schemas/PaginationMeta'

    RecordingDownloadResponse:
      type: object
      required:
        - recordingId
        - downloadUrl
        - expiresInSeconds
      properties:
        recordingId:
          $ref: './common.yaml#/components/schemas/UUID'
        downloadUrl:
          type: string
          format: uri
          description: Presigned URL for downloading
        expiresInSeconds:
          type: integer
          default: 3600
          description: URL 만료 시간 (초)
