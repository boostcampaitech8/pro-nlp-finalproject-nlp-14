"""Agenda/Decision 추출 프롬프트

Version: 1.2.0
Description: 회의록에서 Agenda와 Decision을 추출하는 프롬프트
Changelog:
    1.0.0: 초기 버전 (workflows/extraction.py에서 분리)
    1.1.0: 도메인 용어/규칙 반영하여 추출 지침 강화
    1.2.0: 아젠다/결정 크기 정의(커밋 메시지/코드) 반영
    1.3.0: 실시간 L1 토픽 스냅샷 추가

"""

VERSION = "1.3.0"

# =============================================================================
# Agenda/Decision 추출 프롬프트
# =============================================================================

AGENDA_EXTRACTION_PROMPT = """당신은 회의록 분석 AI입니다. 반드시 JSON 형식으로만 응답해야 합니다.

다음 회의 트랜스크립트를 분석하여 아젠다와 결정사항을 추출하세요.

실시간 L1 토픽 스냅샷 (참고 정보):
{realtime_topics}

트랜스크립트:
{transcript}

분석 지침:
1. 회의에서 논의된 주요 주제(아젠다)를 식별하세요
   - 아젠다 = 커밋 메시지처럼 "한 작업에 대한 한 가지 왜/의미"를 설명하는 작은 단위
   - 가능한 한 작고 구체적으로 쪼개세요 (한 문장, 한 가지 핵심)
   - 큰 주제는 여러 개의 작은 아젠다로 분리하세요 (아젠다 수가 많아져도 됨)
   - 유사한 표현은 하나로 병합하세요
   - 아젠다 순서는 트랜스크립트 등장 순서를 따르세요
   - 트랜스크립트에 없는 내용은 추측하지 마세요
2. 각 아젠다에서 이 회의에서 "합의된 결정"만 추출하세요 (한 안건당 최대 1개)
   - 명시적 합의/확정/결정이 없으면 decision을 null로 두세요
   - 여러 안이 오간 경우 최종 합의된 결과만 남기세요
   - 보류/연기/추가조사로 합의된 것도 결정으로 기록하세요
   - 결정은 아젠다의 결과물(코드)처럼 구체적이고 단일한 결과로 작성하세요 (한 문장 권장)
3. 결정에는 상태나 승인 정보를 넣지 말고, 결정 내용(content)과 근거/맥락(context)만 기록하세요
4. 행동 항목(Action Item), 제안/아이디어, 단순 의견/질문/가설은 decision으로 만들지 마세요
5. 전체 회의를 3-7문장으로 요약하세요
6. 실시간 L1 토픽 스냅샷은 보조 컨텍스트입니다. 트랜스크립트와 충돌하면 트랜스크립트를 우선하세요.
7. 스냅샷/트랜스크립트에 근거 없는 아젠다나 결정사항은 생성하지 마세요.

중요: 다른 텍스트 없이 오직 JSON만 출력하세요!

{format_instructions}

예시:
{{"summary": "이번 회의에서는 로그인 이슈 해결과 배포 일정에 대해 논의했습니다.", "agendas": [{{"topic": "로그인 실패 원인 정리", "description": "리프레시 토큰 만료 처리 방식 확인", "decision": {{"content": "만료 시 재로그인 유도 문구를 고정하기", "context": "CS 문의 증가 원인으로 확인됨"}}}}, {{"topic": "2차 배포 날짜 확정", "description": "테스트 기간을 고려한 일정 조정", "decision": {{"content": "2차 배포를 3월 31일로 확정", "context": "QA 일정과 리소스를 반영"}}}}]}}
"""


# Agenda 추출 결과 스키마 (참고용)
AGENDA_EXTRACTION_SCHEMA = {
    "summary": "회의 전체 요약",
    "agendas": [
        {
            "topic": "작고 구체적인 아젠다 주제 (한 가지 핵심)",
            "description": "아젠다 설명 (1문장 권장)",
            "decision": {
                "content": "이 회의에서 합의된 결정 내용",
                "context": "결정 맥락/근거/제약",
            },  # 또는 null
        }
    ],
}
