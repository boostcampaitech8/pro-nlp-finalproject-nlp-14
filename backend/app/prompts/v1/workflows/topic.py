"""Topic Prompts - 토픽 병합 및 분할 프롬프트 통합 모듈

이 모듈은 회의 토픽의 생성, 병합, 분할에 사용되는 모든 프롬프트를 포함합니다.

## 주요 기능
- 토픽 병합: 유사한 토픽을 하나로 통합
- 토픽 분할: 발화를 토픽별로 분리 및 요약
- 재귀적 토픽 처리: 기존 토픽과 새 발화를 통합

## CHANGELOG
### 1.0.0 (2026-02-03)
- 초기 통합 버전
- topic_merging.py와 topic_separation.py 통합
- 모든 토픽 관련 프롬프트 단일 모듈화
"""

VERSION = "1.0.0"

# ============================================================================
# 토픽 병합 프롬프트
# ============================================================================

TOPIC_MERGE_PROMPT = """
두 개의 유사한 토픽을 하나로 통합하세요.

## 토픽 1: {topic_name_1}
{summary_1}

## 토픽 2: {topic_name_2}
{summary_2}

## 지침
1. 두 요약의 핵심 내용을 모두 포함
2. 중복 정보 제거
3. 시간 순서 유지 (가능한 경우)
4. 500 토큰 이내로 통합
5. 결정사항, 액션아이템이 있으면 명시적으로 표기

## 출력 형식 (JSON만 출력)
{{
    "merged_topic_name": "통합된 토픽 이름 (5단어 이내)",
    "merged_summary": "통합된 3-5문장 요약",
    "keywords": ["키워드 (최대 10개)"]
}}
"""

TOPIC_MERGE_SCHEMA = {
    "type": "object",
    "properties": {
        "merged_topic_name": {"type": "string"},
        "merged_summary": {"type": "string"},
        "keywords": {
            "type": "array",
            "items": {"type": "string"},
            "maxItems": 10,
        },
    },
    "required": ["merged_topic_name", "merged_summary"],
}


TOPIC_NAME_MERGE_PROMPT = """
두 토픽 이름을 하나의 대표 이름으로 통합하세요.

토픽 1: {name_1}
토픽 2: {name_2}

지침:
- 두 토픽의 공통 주제를 반영
- 5단어 이내의 간결한 이름
- 한국어로 작성

출력: 통합된 토픽 이름만 출력 (따옴표 없이)
"""

# ============================================================================
# 토픽 분할 프롬프트
# ============================================================================

TOPIC_SEPARATION_PROMPT = """당신은 회의 내용을 토픽별로 분리하고 요약하는 전문가입니다.

## 출력 형식 (JSON만 출력, 코드펜스/설명문 금지)
{{
    "topics": [
        {{
            "topic_name": "토픽명",
            "summary": "토픽 요약 내용",
            "keywords": ["키워드1", "키워드2", "키워드3"]
        }}
    ]
}}

## 발화 목록 (Turn {start_turn} ~ {end_turn})
{utterances}

## 작업
위 발화들을 **토픽별로 분리**하고 각 토픽에 대해 요약을 작성하세요.

## 규칙
1. 하나의 발화 묶음에서 1~3개의 토픽을 추출합니다 (길어질 것 같으면 토픽 수를 줄이세요)
2. 토픽명은 간결하고 명확하게 작성 (예: "예산 논의", "일정 조율", "기술 검토")
3. 각 토픽의 요약은 핵심 내용 1문장, 120자 이내로 작성
4. 토픽이 명확히 구분되지 않으면 하나의 토픽으로 통합
5. 키워드는 각 토픽에서 중요한 단어 3-5개 추출

## 키 요구사항
- topics는 반드시 리스트
- 각 토픽에 topic_name, summary, keywords 포함
- summary는 반드시 한 줄, 줄바꿈/큰따옴표(") 금지
"""

RECURSIVE_TOPIC_SEPARATION_PROMPT = """당신은 회의 내용을 토픽별로 분리하고 요약하는 전문가입니다.

## 출력 형식 (JSON만 출력, 코드펜스/설명문 금지)
{{
    "topics": [
        {{
            "topic_name": "토픽명",
            "summary": "업데이트된 토픽 요약",
            "keywords": ["키워드1", "키워드2"],
            "is_updated": true
        }}
    ]
}}

## 기존 토픽 요약
{existing_topics}

## 새로운 발화 (Turn {start_turn} ~ {end_turn})
{utterances}

## 작업
기존 토픽 요약과 새 발화를 분석하여:
1. 기존 토픽과 관련된 내용이면 해당 토픽의 요약을 **업데이트**
2. 새로운 주제가 등장하면 **새 토픽 생성**
3. 더 이상 언급되지 않는 토픽은 그대로 유지

## 규칙
1. 기존 토픽명을 최대한 유지하되, 내용이 확장되면 요약 업데이트
2. 완전히 새로운 주제만 새 토픽으로 생성
3. 최종 토픽 수는 30개를 넘지 않도록 유사 토픽 통합 고려
4. 키워드는 기존 키워드 + 새 키워드 병합 (최대 10개)
5. 응답이 길어질 것 같으면 새 토픽 생성을 최소화

## 키 요구사항
- topics는 반드시 리스트
- 기존 토픽 업데이트인 경우 is_updated=true 포함
- 새 토픽이면 is_updated 생략 가능
- summary는 반드시 한 줄, 줄바꿈/큰따옴표(") 금지
"""
